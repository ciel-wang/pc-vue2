/**
 * vxe-table pro v1.0.37
 * Purchase authorization: https://xuliangzhan_admin.gitee.io/vxe-table/plugins/#/pro
 * @copyright x_extends@163.com
 */
/* eslint-disable */
import XEUtils from 'xe-utils'
(function(){var e=Math.abs,t=Math.ceil,l=Math.max,o=Math.min,n=Math.floor;function r(e){return e&&!1!==e.enabled}function s(e,t){return e.type===t}function a(e){return e==="copy"?1:e==="extend"?2:e==="multi"?3:e==="active"?4:0}function i(e,t,l){return e.$vxe.t(t,l)}function d(e){clearTimeout(e._msTout),e._msTout=null}function c(e){e.stopPropagation(),f(e)}function f(e){e.preventDefault()}function u(e,t){return e.querySelector(t)}function h(e){return e.getBoundingClientRect()}function p(e){e&&(e.style.display="block")}function m(e){e&&(e.style.display="")}function g(e,t){e&&e.className&&lt(e.className.split(" "),e=>e!==t).concat([t]).join(" ")}function w(e,t){e&&e.className&&lt(e.className.split(" "),e=>e!==t).join(" ")}function C(e,t){const{$refs:l}=e,{tableBody:o,leftBody:n,rightBody:r}=l;let s=o?o.$el:null;return"left"===t&&n?s=n.$el:"right"==t&&r&&(s=r.$el),s}function v(e){const t=document.createElement("span");return t.className="vxe-table--cell-main-area",e.appendChild(t),t}function x(e,t){t?e.setAttribute("half","1"):e.removeAttribute("half")}function b(e,t){p(e),e.style.height=`${t.height}px`,e.style.width=`${t.width}px`,e.style.left=`${t.left}px`,e.style.top=`${t.top}px`}function R(e,t){const{$el:l}=e;l&&qe(l.querySelectorAll(".vxe-table--cell-area"),t)}function y(e,t){R(e,e=>{const l=e.children[a(t)];m(l)})}function A(e,t){const{editStore:l}=t,{actived:o}=l,{column:n,row:r}=o;if(n&&r){e.stopPropagation();const{offsetRow:l,offsetColumn:n}=$(t,o.row,o.column);t.clearActived(e),t.$nextTick(()=>t.setCellAreas([{type:ft,startRow:l,endRow:l,startColumn:n,endColumn:n}]))}}function I(e,t,l){const{mergeList:o}=e;return Ue(o,({row:e,col:o,rowspan:n,colspan:r})=>t>=e&&t<e+n&&l>=o&&l<o+r)}function E(e,t){const l=h(t);return{offsetY:e.clientY-l.top,offsetX:e.clientX-l.left}}function T(e){const{mergeList:t,afterFullData:l,visibleColumn:o}=e,n=e.getCellAreas();return lt(t,({row:e,col:t,rowspan:r,colspan:s})=>ot(n,n=>{const{rows:a,cols:i}=n,d=Ke(l,st(a)),c=Ke(l,at(a)),f=Ke(o,st(i)),u=Ke(o,at(i));return e>=d&&e+r-1<=c&&t>=f&&t+s-1<=u}))}function F(e,t){const{$vxe:l,afterFullData:o,visibleColumn:n}=e,{modal:r}=l,s=e.getCellAreas(),a=s.length;let d=!1;const c={};for(let l=0;l<a;l++){const t=s[l],{rows:a,cols:f}=t;for(let t=0,l=a.length;t<l;t++){const l=a[t],s=Ke(o,l);for(let o=0,a=f.length;o<a;o++){const a=f[o],u=Ke(n,a),h=s+":"+u;if(c[h])return void(r&&r.message({message:i(e,"vxe.pro.area.multiErr"),status:wt,id:gt}));!d&&(0<t||0<o)&&et(nt(l,a.property))&&(d=!0),c[h]=!0}}}const f=T(e);let u=!1;f.length?e.removeMergeCells(f):(u=!0,e.setMergeCells(s.map(({rows:e,cols:t})=>(qe(e,(e,l)=>{qe(t,(t,o)=>{(0<l||0<o)&&rt(e,t.property,null)})}),{row:st(e),col:st(t),rowspan:e.length,colspan:t.length}))));const h=s.map(({rows:e,cols:t})=>({rows:e,cols:t}));e.emitEvent("cell-area-merge",{status:u,targetAreas:h},t)}function $(e,t,l){const{afterFullData:o,visibleColumn:n}=e,r=Ke(o,t),s=Ke(n,l),a=I(e,r,s);if(a){const{row:e,col:r}=a;t=o[e],l=n[r]}return{offsetRow:t,offsetColumn:l}}function S(e,t,l){const{mergeList:o,afterFullData:n,visibleColumn:r}=e;if(o.length){const o=st(t),s=st(l),a=Ke(n,o),i=Ke(r,s),d=a+t.length-1,c=i+l.length-1;let f=a,u=i,h=d,p=c;for(let t=f;t<=h;t++)for(let l=u;l<=p;l++){const o=I(e,t,l);if(o){const{row:e,col:n,rowspan:r,colspan:s}=o,a=e+r-1,i=n+s-1;let d=!1;e<f&&(d=!0,f=e),n<u&&(d=!0,u=n),a>h&&(d=!0,h=a),i>p&&(p=i,d=!0),d&&(t=f,l=u)}}return{rows:Ye(n,f,h+1),cols:Ye(r,u,p+1)}}return{rows:t,cols:l}}function k(e,t,l,o,r,s){const{afterFullData:a,visibleColumn:i,scrollYLoad:d,scrollYStore:c}=e,{rowHeight:f}=c;if(d)return(n(s/f)+1)*f;let u=0;const h=(r?"next":"previous")+"ElementSibling";if(r&&o){const{row:e,col:n}=o;t=a[e],l=i[n]}const p=e.getCell(t,l);for(let n=p.parentNode;n&&s>=u;)u+=n.offsetHeight,n=n[h];return u}function M(e,t,l,o,n,r){const{visibleColumn:s}=e;let a=0;if(n)for(let e=Ke(s,l)+1,t=s.length;e<t;e++){const t=s[e];if(a+=t.renderWidth,a>=r)return a}else for(let e=Ke(s,l)-1;0<=e;e--){const t=s[e];if(a+=t.renderWidth,a>=r)return a}return a}function D(e,t,r,s,a,i){const{afterFullData:d,scrollYLoad:c,scrollYStore:f}=e;let u=0,h=0,p=[];const m=Ke(d,t);if(c){const{rowHeight:e}=f;h=n(i/e)+1,u=h*e}else{const e=a?"nextElementSibling":"previousElementSibling";for(a&&(h++,u+=s.offsetHeight);s&&i>=u;)u+=s.offsetHeight,s=s[e],h++}return p=a?Ye(d,m,o(d.length+1,m+h)):Ye(d,l(0,m-h),m+1),{moveHeight:u,moveSize:h,rows:p}}function V(e,t,l,o,n,r){const{visibleColumn:s}=e;let a=0;const i=[l];let d=Ke(s,l);if(n){a+=l.renderWidth,d++;for(let e=s.length;d<e&&!(a>=r);d++){const e=s[d];i.push(e),a+=e.renderWidth}}else for(d--;0<=d&&!(a>=r);d--){const e=s[d];i.unshift(e),a+=e.renderWidth}return{moveWidth:a,moveSize:i.length,cols:i}}function W(e,t,l){const{visibleColumn:o}=e,{left:n,width:r}=l;let s=0;const a=[];for(let i=0,d=o.length;i<d;i++){const e=o[i];if(s>=n&&a.push(e),s+=e.renderWidth,s>=n+r)return a}return a}function O(e,t,l){const{afterFullData:o,scrollYLoad:r,scrollYStore:s}=e,{top:a,height:i}=l;if(r){const{rowHeight:e}=s,t=n(a/e);return Ye(o,t,t+n(i/e))}let d=0;const c=[];for(;t&&d+2<a+i;){if(d+2>=a){const l=e.getRowNode(t);if(l)c.push(l.item);else break}d=t.offsetTop+t.offsetHeight,t=t.nextElementSibling}return c}function L(e,t){const{visibleColumn:l,afterFullData:o,scrollYLoad:n,scrollYStore:r}=e,{type:s,area:a,column:i,row:d}=t;let c=i,f=d;const h=C(e,c.fixed),p=u(h,".vxe-table--cell-area"),m=p.children,g=m[4];let w=Ke(l,c),v=Ke(o,f);if(a&&-1<w&&-1<v){let t=0,u=0,h=0,p=0;const m=I(e,v,w);if(m){const{row:t,col:n,rowspan:r,colspan:u}=m;return v=t,f=o[v],w=n,c=l[w],He(H(e,{type:s,rows:Ye(o,v,v+r),cols:Ye(l,w,w+u)}),{area:a,column:i,row:d})}if(t+=i.renderWidth,qe(Ye(l,0,w),e=>{p+=e.renderWidth}),n){const{rowHeight:e}=r;if(h=v*e,m){const{rowspan:t}=m;u=e*t}else u=e}else{const t=e.getCell(f,c),l=t.parentNode;h=l.offsetTop,u=t.offsetHeight}const C={type:s,area:a,column:i,row:d,top:h,left:p,width:t,height:u};return b(g,C),C}return null}function N(e,t,l,o,n,r){const{showOverflow:s,spanMethod:a,scrollXLoad:i,columnStore:d,keyboardConfig:c,keyboardOpts:f,mergeList:h,visibleColumn:g,afterFullData:w,scrollYLoad:R,scrollYStore:y}=e,{type:A,cols:E}=t,T=C(e,o),F=u(T,".vxe-table--cell-area"),$=F.children,S=$[0],k=$[1],M=$[2],D=$[3],V=$[4],L=u(T,".vxe-body--row"),N=L.firstChild;let H=st(r),Y=st(n),_=at(r),B=at(n),K=Ke(g,Y),P=Ke(w,H),X=Ke(g,B),q=Ke(w,_),j=0,z=0;const U=[];if(h.length&&qe(r,(t,l)=>{const o=Ke(w,t);qe(n,(t,s)=>{const a=Ke(g,t),i=I(e,o,a);if(i){const{row:e,col:t,rowspan:o,colspan:a}=i;0===l&&0===s&&(P=e,H=w[P]),l===r.length-1&&s===n.length-1&&(q=e,j=o-1,_=w[q]),0===l&&0===s&&(K=t,Y=g[K]),l===r.length-1&&s===n.length-1&&(X=t,z=a-1,B=g[X]),i&&-1===Ke(U,i)&&U.push(i)}})}),-1<K&&-1<X&&-1<P&&-1<q){let r=0,u=0,w=0,C=0,I=Ye(g,0,K);if("right"===o){const e=d.rightList;let t=[];h.length||a||c&&f.isMerge||(o&&s?t=e:i&&o&&(t=e)),t.length&&(I=Ye(t,0,Ke(t,g[K])))}if(qe(I,e=>{C+=e.renderWidth}),qe(Ye(g,K,X+z+1),e=>{r+=e.renderWidth}),R){const{rowHeight:e}=y;w=P*e,u=(q+j+1-P)*e}else{const t=e.getCell(H,Y),l=e.getCell(_,B),o=t.parentNode,n=l.parentNode;w=o.offsetTop,u=n.offsetTop+l.offsetHeight-w}const T={el:t.el,leftEl:t.leftEl,rightEl:t.rightEl,type:A,cols:[],rows:[],top:w,left:C,width:r,height:u},$=!!o&&n.length!==E.length;if(T.cols=W(e,N,T),T.rows=O(e,L,T),p(F),A===ft)l?p(S.firstChild):m(S.firstChild),x(S,$),b(S,T);else if(A===ut)x(k,$),b(k,T);else if(A===ht)x(M,$),b(M,T);else if(A===pt){const e=o?`${o}El`:"el",t=T[e]||v(D);T[e]=t,x(t,$),b(t,T)}else A===mt&&(x(V,$),b(V,T));return T}return null}function H(e,t){const{$refs:l}=e,{type:o,cols:n,rows:r}=t,s=l.leftContainer,a=l.rightContainer;let i=[],d=[];return o!==pt&&y(e,o),s&&(i=lt(n,e=>"left"===e.fixed),i.length&&N(e,t,n.length===i.length,"left",i,r)),a&&(d=lt(n,e=>"right"===e.fixed),d.length&&N(e,t,!0,"right",d,r)),N(e,t,!d.length,null,n,r)}function Y(e,t){const{visibleColumn:l,afterFullData:o}=e,{type:n,startColumn:r,endColumn:s,startRow:a,endRow:i}=t,d=Ke(o,a),c=Ke(o,i),f=Ke(l,r),u=Ke(l,s),h=Ye(o,d,c+1),p=Ye(l,f,u+1),{rows:m,cols:g}=S(e,h,p);return H(e,{type:n,rows:m,cols:g})}function _(e){return /\n/.test(e)?`"${e.replace(/"/g,"\"\"")}"`:e}function B(e){return e.replace(/"/g,"&quot;")}function K(e){return Be(e)?e?"TRUE":"FALSE":e}function P(e,t,l,o){const{seqOpts:n}=e,r=n.seqMethod;let a;return a=s(l,vt)?r?r({row:t,rowIndex:e.getRowIndex(t),column:l,columnIndex:e.getColumnIndex(l)}):o:s(l,xt)?e.isCheckedByCheckboxRow(t):s(l,bt)?e.isCheckedByRadioRow(t):nt(t,l.property),a}function X(e,t,l){const o=[],n=[];if(t){const{afterFullData:r,visibleColumn:s,clipOpts:a}=e,{cols:i,rows:d}=t,c=a.copyMethod||a.getMethod;let f=Ke(r,st(d));qe(d,t=>{const a=[],d=[],u=Ke(r,t);f++,qe(i,o=>{const n=Ke(s,o),r=I(e,u,n);let i=P(e,t,o,f);if(c&&(i=c({isCut:l,row:t,column:o,cellValue:i,$table:this})),i=et(K(i)),r){const{row:e,col:t,rowspan:l,colspan:o}=r;u===e&&n===t&&a.push(`<td rowspan="${l}" colspan="${o}">${B(i)}</td>`)}else a.push(`<td>${B(i)}</td>`);d.push(_(i))}),o.push(d),n.push(`<tr>\n${a.join("")}\n</tr>`)})}const r=n.length?["<html>","<head>","<meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui\">","</head>","<body>","<table border=0 cellpadding=0 cellspacing=0>",n.join("\n"),"</table>","</body>","</html>"]:[];return{area:t,cellValues:o,text:o.map(e=>e.join("\t")).join(dt),html:r.join(dt)}}function q(e){const t=document.activeElement,l=e.getCellAreas(),o=t?t.tagName:"";return l.length&&(!o||!Pe(["input","textarea"],o.toLowerCase()))}function j(e,t,l){const{clipOpts:o}=e,{afterCopyMethod:n}=o;n&&n({isCut:l,targetAreas:t.targetAreas,$table:e})}function z(e,t,l){const{$vxe:o,clipOpts:n,filterStore:r}=e,{modal:s}=o,a=n.beforeCopyMethod||n.beforeGetMethod,d=e.getCellAreas(),c={text:"",html:""};let u,h=!1,p=[];if(!r.visible){if(t&&f(t),1===d.length){const t=st(d);if(t){const{rows:o,cols:n}=t,r=Ye(o,0),s=Ye(n,0);if(p=[{rows:r,cols:s}],!a||!1!==a({isCut:l,targetAreas:p,$table:e})){const o=He({},t,{cut:l,type:ut,rows:r,cols:s});h=!0,u=X(e,t,l),c.text=u.text,c.html=u.html,e.copyAreaMpas=He(o,H(e,o))}}}else 1<d.length&&s&&s.message({message:i(e,"vxe.pro.area.multiErr"),status:wt,id:gt});t&&e.emitEvent(l?"cell-area-cut":"cell-area-copy",{status:h,targetAreas:h?p:[],cellValues:u?u.cellValues:[]},t),o.clipboard=c}return{status:h,targetAreas:p,text:c.text,html:c.html}}function U(e,t){return e.replace(/#\d+@\d+/g,e=>je(t,e)?t[e]:e)}function Z(e){return`#${e}@${Oe()}`}function G(e,l){const o=U(e,l);return o.replace(/^"+$/g,e=>"\"".repeat(t(e.length/2)))}function J(e){return"TRUE"===e||"true"===e||!0===e}function Q(e,l,n,r){const{clipOpts:s}=e,{isFillPaste:a}=s,i=r.map(e=>e.slice(0)),d=l.length,c=n.length,f=r.length,u=r[0].length;if(a||0==d%f&&0==c%u){if(d>f){const e=r.map(e=>e.slice(0));for(let l=t(d/f)-2;0<=l;)i.push(...e.map(e=>e.slice(0))),l--;a&&(i.length=o(i.length,d))}c>u&&i.forEach(e=>{const l=e.slice(0);for(let o=t(c/u)-2;0<=o;)e.push(...l.slice(0)),o--;a&&(e.length=o(e.length,c))})}return i}function ee(e,t,l){const{$vxe:o,clipOpts:n,copyAreaMpas:r,filterStore:a}=e,{cutMethod:d,afterCutMethod:c,beforeCutMethod:u,afterPasteMethod:h}=n,p=n.pasteMethod||n.setMethod,m=n.beforePasteMethod||n.beforeSetMethod,{modal:g}=o,w=e.getCellAreas();let C=!1,v=[];if(!a.visible){if(t&&f(t),1===w.length){const t=st(w),{rows:o,cols:n}=t,a=st(n),f=st(o),x=[],b=w.map(({rows:e,cols:t})=>({rows:e,cols:t})),R=[],y=r&&r.cut;if(y){const{cols:t,rows:l}=r;if(R.push({rows:t,cols:l}),!u||!1!==u({cutAreas:R,currentAreas:b,$table:e})){let o;const n=null;qe(l,l=>{qe(t,t=>{if(d)d({row:l,column:t,cellValue:n,$table:e});else{const{property:r}=t;s(t,xt)?e.setCheckboxRow(l,!1):s(t,bt)?e.isCheckedByRadioRow(l)&&(o=l):r&&rt(l,r,n)}})}),o&&e.clearRadioRow(),e.clearCopyCellArea(),c&&c({cutAreas:R,currentAreas:b,$table:e})}}const{text:A}=l,E={},T=Date.now();let F,$;A&&qe(A.replace(/(^\r\n)|(\r\n$)/,"").split(dt),e=>{const t=[];qe(e.split(yt),e=>{let l=e.trim();/\n/.test(l)&&(l=U(l.replace(/("")|(\n)/g,(e,t)=>{const l=Z(T);return E[l]=t?"\"":"\n",l}).replace(/"(.*?)"/g,(e,t)=>G(t,E)),E)),t.push(l)}),x.push(t)});const S=(t,l,o)=>{p?p({isCut:y,row:t,column:l,cellValue:o,$table:this}):s(l,xt)?e.setCheckboxRow(t,J(o)):s(l,bt)?(!F&&(F=l),J(o)&&($=t)):l.property&&rt(t,l.property,o)};if(1===x.length&&1===x[0].length){v=b;const t=x,l={isCut:y,cutAreas:R,currentAreas:b,targetAreas:v,cellValues:t,pasteCells:t,$table:e};m&&!1===m(l)||le(e,l).then(e=>{const l=t[0][0];C=!0,qe(w,e=>{const{rows:t,cols:o}=e;qe(t,e=>{qe(o,t=>{S(e,t,l)})})}),h&&h(e)})}else if(1===w.length){const{visibleColumn:t,afterFullData:l}=e;let r=f,s=a;const d=Ke(l,f),c=Ke(t,a);if(-1<c&&-1<d){const u=[],p=[],w=[],A=Q(e,o,n,x),E=A.length,T=A[0].length;for(let o=0;o<E;o++){const n=A[o],h=d+o,m=l[h];if(m){const C=[];for(let u=0;u<T;u++){const m=n[u],w=c+u,v=t[w];if(v){const n=I(e,h,w);if(n){const{row:o,col:u,rowspan:h,colspan:p}=n;if(d+E<o+h||c+T<u+p)return r=l[o+h-1],s=t[u+p-1],e.setCellAreas([{type:ft,startColumn:a,endColumn:s,startRow:f,endRow:r}],{column:a,row:f}),void(g&&g.message({message:i(e,"vxe.pro.area.mergeErr"),status:wt,id:gt}))}o||p.push(v),C.push(m)}}u.push(m),w.push(C)}}v=[{rows:u,cols:p}];const F={isCut:y,cutAreas:R,currentAreas:b,targetAreas:v,cellValues:w,pasteCells:A,$table:e};m&&!1===m(F)||le(e,F).then(t=>{const{visibleColumn:l,afterFullData:o}=e,{insertColumns:n,insertRows:i}=t;C=!0,qe(w,(e,t)=>{const n=o[d+t];n&&(r=n,qe(e,(e,t)=>{const o=l[c+t];o&&(s=o,S(n,o,e))}))}),n.length?(s=at(n),qe(A,(e,t)=>{const l=o[d+t],r=e.length-n.length;l&&qe(n,(t,o)=>{const n=e[r+o];S(l,t,n)})})):!i.length&&e.setCellAreas([{type:ft,startColumn:a,endColumn:s,startRow:f,endRow:r}],{column:a,row:f}),h&&h(F)})}}else g&&g.message({message:i(e,"vxe.pro.area.multiErr"),status:wt,id:gt});F&&($?e.setRadioRow($):e.clearRadioRow())}else 1<w.length&&g&&g.message({message:i(e,"vxe.pro.area.multiErr"),status:wt,id:gt});t&&e.emitEvent("cell-area-paste",{status:C,targetAreas:C?v:[]},t)}}function te(e){const t=[];for(;0<=e;){const l=e%26;t.push(String.fromCharCode(l+97)),e=ze(e/26)-1}return t.reverse().join("")}function le(e,t){const{tableFullColumn:l,clipOpts:o}=e,{isRowIncrement:n,isColumnIncrement:r,createRowsMethod:a,createColumnsMethod:i}=o,{targetAreas:d,pasteCells:c}=t,f=c[0],u=d[0],{rows:h,cols:p}=u,m=He({},t,{insertRows:[],insertColumns:[]}),g=n&&c.length>h.length,w=r&&f.length>p.length,C=st(h);let v=at(h);const x=st(p);let b,R=at(p),y=[];if(w){let t=e.azIndex;const o=f.slice(p.length);if(t||(t=l.length),o.forEach(()=>{const e=te(t++);y.push({field:e,title:e.toUpperCase(),width:100})}),i&&(m.insertColumns=y,y=i(m)),y&&y.length&&(e.azIndex=t+1,b=e.loadColumn(l.concat(y)).then(()=>{const{visibleColumn:t}=e;return R=at(t),m.insertColumns=t.slice(t.length-y.length),g||e.setCellAreas([{type:ft,startColumn:x,endColumn:R,startRow:C,endRow:v}],{column:x,row:C}),m})),!g)return Promise.resolve(b||m)}if(g){const t=c.slice(h.length),l=[];let o,n,r=t.map((e,t)=>{const r={};return e.forEach((e,a)=>{const i=p[a];i&&(s(i,xt)?l.push({rIndex:t,checked:J(e)}):s(i,bt)?(!o&&(o=i),J(e)&&(n=a)):i.property&&rt(r,i.property,e))}),r});if(a&&(m.insertRows=r,r=a(m)),r&&r.length)return Promise.resolve(b).then(()=>e.insertAt(r,-1).then(({rows:t})=>{const{afterFullData:r}=e;return v=at(r),m.insertRows=t,o&&(t[n]?e.setRadioRow(t[n]):e.clearRadioRow()),l.forEach(l=>{e.setCheckboxRow(t[l.rIndex],l.checked)}),e.setCellAreas([{type:ft,startColumn:x,endColumn:R,startRow:C,endRow:v}],{column:x,row:C}),m}))}return Promise.resolve(m)}function oe(e,t,l){const{afterFullData:o,visibleColumn:n}=e,r=Ke(o,st(t)),s=Ke(n,st(l));for(let o=0,n=t.length;o<n;o++){const t=r+o;for(let o=0,a=l.length;o<a;o++){const l=s+o,i=I(e,t,l);if(i){const{row:e,col:t,rowspan:l,colspan:o}=i;if(r>e||r+n<e+l||s>t||s+a<t+o)return!1}}}return!0}function ne(e,t,l,o){const{afterFullData:n,visibleColumn:r}=e,s=Ke(n,l),a=Ke(r,o);if(t.length){if(1===t.length){const{cols:l,rows:o}=st(t);if(1===l.length&&1===o.length)return!0;else{const t=Ke(n,st(o)),i=Ke(r,st(l)),d=I(e,s,a);if(d){const{row:e,col:n,rowspan:r,colspan:s}=d;if(t===e&&o.length===r&&i===n&&l.length===s)return!0}}}return!1}return!0}function re(e,t,l,o){const{afterFullData:n,visibleColumn:r}=e;let s=n[t];const a=r[l];if(s){const t=Ke(n,s),l=Ke(r,a),o=I(e,t,l);if(o){const{row:e}=o;t!==e&&(s=n[e])}}else if(o)return l--,0>l&&(l=r.length-1),t=n.length-1,re(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function se(e,t,l,o){const{afterFullData:n,visibleColumn:r}=e;let s=n[t];const a=r[l];if(s){const t=Ke(n,s),l=Ke(r,a),o=I(e,t,l);if(o){const{row:e,rowspan:l}=o;t!==e&&(s=n[e+l-1+1])}}else if(o)return l++,l>r.length-1&&(l=0),t=0,se(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function ae(e,t,l,o){const{afterFullData:n,visibleColumn:r}=e,s=n[t];let a=r[l];if(a){const t=Ke(n,s),l=Ke(r,a),o=I(e,t,l);if(o){const{col:e}=o;l!==e&&(a=r[e])}}else if(o)return t--,0>t&&(t=n.length-1),l=r.length-1,ae(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function ie(e,t,l,o){const{afterFullData:n,visibleColumn:r}=e,s=n[t];let a=r[l];if(a){const t=Ke(n,s),l=Ke(r,a),o=I(e,t,l);if(o){const{col:e,colspan:t}=o;l!==e&&(a=r[l+t-1+1])}}else if(o)return t++,t>n.length-1&&(t=0),l=0,ie(e,t,l,o);return{offsetRow:s,offsetColumn:a}}function de(e,t,l,o,n){const{afterFullData:r,visibleColumn:s}=e,a=t[l],{cols:i,rows:d}=a;let c=d[o];const f=i[n];if(c){const u=Ke(r,c),h=Ke(s,f),p=I(e,u,h);if(p){const{row:s,col:m}=p,g=Ke(d,r[s]);return u===s&&h===m?(o=g,c=d[n],{offsetArea:a,offsetRow:c,offsetColumn:f}):(h===m?(o=g,c=d[o]):(o=g-1,0>o&&(n--,0>n&&(n=i.length-1),o=d.length-1)),de(e,t,l,o,n))}return{offsetArea:a,offsetRow:c,offsetColumn:f}}return n--,0>n?(l--,0>l&&(l=t.length-1),o=t[l].rows.length-1,n=t[l].cols.length-1):o=d.length-1,de(e,t,l,o,n)}function ce(e,t,l,o,n){const{afterFullData:r,visibleColumn:s}=e,a=t[l],{cols:i,rows:d}=a;let c=d[o];const f=i[n];if(c){const u=Ke(r,c),h=Ke(s,f),p=I(e,u,h);if(p){const{row:s,col:m,rowspan:g}=p,w=Ke(d,r[s]);return u===s&&h===m?(o=w,c=d[o],{offsetArea:a,offsetRow:c,offsetColumn:f}):(h===m?(o=w+g-1+1,c=d[o]):(o=w+g-1+1,o>d.length+1&&(n++,o>i.length-1&&(n=0),o=0)),ce(e,t,l,o,n))}return{offsetArea:a,offsetRow:c,offsetColumn:f}}return o++,n++,o>d.length-1&&(o=0),n>i.length-1&&(l++,l>t.length-1&&(l=0),n=0),ce(e,t,l,o,n)}function fe(e,t,l,o,n,r,s){f(e);const a=13===e.keyCode,{afterFullData:i,visibleColumn:d}=t,{row:c,column:u}=l,h=t.getCellAreas(),p=!a||ne(t,h,c,u);if(p){let e=Ke(i,c),l=Ke(d,u),f=c,h=u;const p=I(t,e,l);if(n){if(p){const{row:t}=p;e=t}const{offsetRow:o,offsetColumn:n}=re(t,e-1,l,a);f=o,h=n}else if(s){if(p){const{row:t,rowspan:l}=p;e=t+l-1}const{offsetRow:o,offsetColumn:n}=se(t,e+1,l,a);f=o,h=n}else if(o){if(p){const{col:e}=p;l=e}const{offsetRow:o,offsetColumn:n}=ae(t,e,l-1);f=o,h=n}else if(r){if(p){const{col:e,colspan:t}=p;l=e+t-1}const{offsetRow:o,offsetColumn:n}=ie(t,e,l+1);f=o,h=n}f&&h&&(t.scrollToRow(f,h),t.setCellAreas([{type:ft,startColumn:h,endColumn:h,startRow:f,endRow:f}],{column:h,row:f}))}else{const e=t.getActiveCellArea();if(e){const{area:l,row:o,column:r}=e,s=Je(h,e=>e===l);let a=h[s],i=o,d=r;if(a){const{cols:e,rows:l}=a,c=Ke(l,o),f=Ke(e,r),{offsetArea:u,offsetRow:p,offsetColumn:m}=n?de(t,h,s,c-1,f):ce(t,h,s,c+1,f);a=u,i=p,d=m}i&&d&&t.scrollToRow(i,d).then(()=>{t.setActiveCellArea({area:a,column:d,row:i})})}}}function ue(e,t,l,o,n){const{$vxe:r,afterFullData:s,visibleColumn:a}=t,{modal:d}=r;if(f(e),1>=o.length){const{row:e,column:o}=l,{row:r,column:i}=n,d=Ke(s,e),c=Ke(a,o),f=Ke(s,r),u=Ke(a,i),h=d>f?r:e,p=d>f?e:r,m=c>u?i:o,g=c>u?o:i;t.setCellAreas([{type:ft,startRow:h,endRow:p,startColumn:m,endColumn:g}],{column:o,row:e})}else d&&d.message({message:i(t,"vxe.pro.area.multiErr"),status:wt,id:gt})}function he(e,t,n,r,s,a,i){f(e);const{afterFullData:d,visibleColumn:c}=t,{area:u,row:h,column:p}=n,{rows:m,cols:g}=u;let w=st(m),C=at(m),v=st(g),x=at(g);const b=Ke(d,h),R=Ke(c,p);let y=Ke(d,w),A=Ke(c,v),E=Ke(d,C),T=Ke(c,x),F=m,$=g;const k=I(t,b,R);if(s||i){if(s){if(qe(g,e=>{const l=Ke(c,e),n=I(t,E,l);if(n){const{row:e}=n;E=o(E,e)}}),E>(k?b+k.rowspan-1:b))E-=1,C=d[E];else{if(0>=y)return;y-=1,w=d[y]}}else if(qe(g,e=>{const o=Ke(c,e),n=I(t,y,o);if(n){const{row:e,rowspan:t}=n;y=l(y,e+t-1)}}),y<(k?b+k.rowspan-1:b))y+=1,w=d[y];else{if(E>=d.length-1)return;E+=1,C=d[E]}const{rows:e,cols:n}=S(t,Ye(d,y,E+1),$);F=e,$=n}else{if(r){if(qe(m,e=>{const l=Ke(d,e),n=I(t,l,T);if(n){const{col:e}=n;T=o(T,e)}}),T>(k?R+k.colspan-1:R))T-=1,x=c[T];else{if(0>=A)return;A-=1,v=c[A]}}else if(qe(m,e=>{const o=Ke(d,e),n=I(t,o,A);if(n){const{col:e,colspan:t}=n;A=l(A,e+t-1)}}),A<(k?R+k.colspan-1:R))A+=1,v=c[A];else{if(T>=c.length-1)return;T+=1,x=c[T]}const{rows:e,cols:n}=S(t,F,Ye(c,A,T+1));F=e,$=n}w=st(F),C=at(F),v=st($),x=at($),s||i?t.scrollToRow(st(m)===w?C:w):t.scrollToColumn(st(g)===v?x:v),t.setCellAreas([{type:ft,startRow:w,endRow:C,startColumn:v,endColumn:x}],{column:p,row:h})}function pe(e,t,l,o,n){const{afterFullData:r,visibleColumn:s}=e,a=t[l],{cols:i,rows:d}=a,c=d[o];let f=i[n];if(f){const u=Ke(r,c),h=Ke(s,f),p=I(e,u,h);if(p){const{row:r,col:m}=p,g=Ke(i,s[m]);return u===r&&h===m?(n=g,f=i[n],{offsetArea:a,offsetRow:c,offsetColumn:f}):(u===r?(n=g,f=i[n]):(n=g-1,0>n&&(o--,0>o&&(o=d.length-1),n=i.length-1)),pe(e,t,l,o,n))}return{offsetArea:a,offsetRow:c,offsetColumn:f}}return o--,0>o?(l--,0>l&&(l=t.length-1),o=t[l].rows.length-1,n=t[l].cols.length-1):n=i.length-1,pe(e,t,l,o,n)}function me(e,t,l,o,n){const{afterFullData:r,visibleColumn:s}=e,a=t[l],{cols:i,rows:d}=a,c=d[o];let f=i[n];if(f){const u=Ke(r,c),h=Ke(s,f),p=I(e,u,h);if(p){const{row:r,col:m,colspan:g}=p,w=Ke(i,s[m]);return u===r&&h===m?(n=w,f=i[n],{offsetArea:a,offsetRow:c,offsetColumn:f}):(u===r?(n=w+g-1+1,f=i[n]):(n=w+g-1+1,n>i.length-1&&(o++,o>d.length-1&&(l++,l>t.length-1&&(l=0),o=0),n=0)),me(e,t,l,o,n))}return{offsetArea:a,offsetRow:c,offsetColumn:f}}return o++,o>d.length-1?(l++,l>t.length-1&&(l=0),o=0,n=0):n=0,me(e,t,l,o,n)}function ge(e,t,l,o){const{afterFullData:n,visibleColumn:r}=t,{column:s,row:a}=l,i=t.getCellAreas(),d=ne(t,i,a,s);if(d){const e=Ke(n,a);let l=Ke(r,s),i=a,d=s;const c=I(t,e,l);if(c){const{col:e,colspan:t}=c;l=o?e:l+t-1}const{offsetRow:f,offsetColumn:u}=o?ae(t,e,l-1,!0):ie(t,e,l+1,!0);i=f,d=u,i&&d&&(t.scrollToRow(i,d),t.setCellAreas([{type:ft,startColumn:d,endColumn:d,startRow:i,endRow:i}],{column:d,row:i}))}else{const e=t.getActiveCellArea();if(e){const{area:l,row:n,column:r}=e,s=Je(i,e=>e===l);let a=i[s],d=n,c=r;if(a){const{cols:e,rows:l}=a,f=Ke(l,n),u=Ke(e,r),{offsetArea:h,offsetRow:p,offsetColumn:m}=o?pe(t,i,s,f,u-1):me(t,i,s,f,u+1);a=h,d=p,c=m}d&&c&&t.scrollToRow(d,c).then(()=>{t.setActiveCellArea({area:a,column:c,row:d})})}}}function we(e,t,l,o,n,r,s,a,i){const{clientX:d,clientY:c}=e,{$refs:f,scrollbarWidth:u}=t,p=f.leftContainer,m=f.rightContainer,g=d-o,w=c-n,C=a.scrollLeft,v=i.scrollTop;let x=g+(C-r);let b,R,y=0;p&&(y=p.offsetWidth,b=h(p)),m&&(R=h(m));const{scrollWidth:A,offsetWidth:I}=a,E=A-I-C;return b&&R?"left"===l?d>R.left?x=g+C+u+E:d<b.left+y&&(x=g):"right"===l?d<b.left+y?x=g-u-E-C:d<R.left&&(x=g-u-E):d<b.left+y?x=g-u-(r-C)-C:d>R.left&&(x=g+(C-r)+u+E):b?"left"===l?d<b.left+y&&(x=g):d<b.left+y&&(x=g-u-(r-C)-C):R&&("right"===l?d<R.left&&(x=g-u-E):d>R.left&&(x=g+(C-r)+u+E)),{moveX:g,moveY:w,offsetLeft:x,offsetTop:w+(v-s)}}function Ce(t,l){const{$vxe:o,fnrStore:n}=t,{modal:r}=o;if(n.showREErr=!1,n.findCellRE=null,n.isRE)try{n.findCellRE=new RegExp(l,n.isSensitive?"":"i")}catch(l){return n.showREErr=!0,r&&r.message({message:i(t,"vxe.pro.fnr.reError"),status:wt,id:gt}),!1}return!0}function ve(e,t,l,o){if(l.property){const{fnrStore:n,fnrOpts:r}=e,{isWhole:s,isRE:a,isSensitive:i,findCellRE:d}=n,{findMethod:c}=r;let f=et(nt(t,l.property));return c?c({cellValue:f,isWhole:s,isRE:a,isSensitive:i,findValue:o,findRE:d}):o?a?d&&d.test(f):(i||(f=f.toLowerCase(),o=o.toLowerCase()),s?f===o:-1<Ke(f,o)):!f}return!1}function xe(e,t,l,o,n,r,s,a,i,d){const{afterFullData:c,visibleColumn:f}=e,u=[];for(let h=l,p=t.length;h<p;h++){const p=t[h],{rows:m,cols:g}=p,w=Ke(c,st(m)),C=Ke(f,st(g));for(let t=h===l?n:0,v=m.length;t<v;t++){const m=w+t;for(let w=h===l&&t===n?s:0,v=g.length;w<v;w++){const l=C+w,n=I(e,m,l);if(n){const{row:e,col:t}=n;if(m!==e||l!==t)continue}const s=c[m],g=f[l];if(ve(e,s,g,i)&&(u.push({_rowIndex:m,_columnIndex:l,offsetArea:p,offsetRow:s,offsetColumn:g}),!d))return u;if(h>=o&&t>=r&&w>=a)return u}}}return u}function be(e,t,l,o,n,r,s){const{afterFullData:a,visibleColumn:i}=e,d=Ke(a,t),c=Ke(i,l)+1,f=Ke(a,o),u=Ke(i,n)+1,h=[];for(let p=0,m=a.length;p<m;p++){const t=d+p;for(let l=0==p?c:0,o=i.length;l<o;l++){const o=I(e,t,l);if(o){const{row:e,col:n}=o;if(t!==e||l!==n)continue}const n=a[t],d=i[l];if(ve(e,n,d,r)&&(h.push({_rowIndex:t,_columnIndex:l,offsetRow:n,offsetColumn:d}),!s))return h;if(p>=f&&l>=u)return h}}return h}function Re(e){const{fnrActiveModal:t}=e;e.$nextTick(()=>{if(t){const l=u(t.$el,".vxe-table--fnr-form-input .vxe-input--inner");l&&(e.blur(),l.focus())}})}function ye(e,t){const{afterFullData:l,visibleColumn:o,fnrStore:n}=e,r=e.getActiveCellArea(),s=e.getCellAreas();let a=st(l),i=st(o),d=at(l),c=at(o);const f=et(n.findValue);let u=[],h=!0;if(n.showREErr=!1,!Ce(e,f))return u;if(r){const{row:l,column:o}=r;h=ne(e,s,l,o),!t&&h&&(a=l,i=o)}if(h){if(u=be(e,a,i,d,c,f,t),!t&&(u.length||(d=a,c=i,a=st(l),i=st(o),u=be(e,a,i,d,c,f,t)),u.length)){const{offsetRow:t,offsetColumn:l}=u[0];e.scrollToRow(t,l),e.setCellAreas([{type:ft,startRow:t,endRow:t,startColumn:l,endColumn:l}])}}else if(r){const{area:l,row:o,column:n}=r;let a=t?0:Je(s,e=>e===l);const i=s[a];if(i){const{cols:l,rows:r}=i;let d=t?0:Ke(r,o),c=t?0:Ke(l,n)+1,h=s.length-1;const p=s[h];let m=p.rows.length-1,g=p.cols.length-1;if(u=xe(e,s,a,h,d,m,c,g,f,t),!t&&(u.length||(h=a,m=d,g=c,a=0,d=0,c=0,u=xe(e,s,a,h,d,m,c,g,f,t)),u.length)){const{offsetArea:t,offsetRow:l,offsetColumn:o}=u[0];e.scrollToRow(l,o).then(()=>{e.setActiveCellArea({area:t,column:o,row:l})})}}}return u}function Ae(e){qe(e.fnrSearchList,e=>{e.isActived=!1})}function Ie(e,t){const{$vxe:l,fnrOpts:o,fnrStore:n,fnrTabs:r}=e,{modal:s}=l,a=e.getActiveCellArea(),d=lt(r,e=>"find"===e.value&&!!o.isFind||"replace"===e.value&&!!o.isReplace),c=-1<Ke(d,t)?t:d[0];c&&(n.visible=!0,n.activeTab=c.value,n.findValue=a?nt(a.row,a.column.property):"",s.open({title:i(e,"vxe.pro.fnr.title"),className:"vxe-table--ignore-areas-clear vxe-table--fnr",size:e.vSize,width:540,minWidth:540,height:370,minHeight:370,resize:!0,showZoom:!0,lockView:!1,mask:!1,escClosable:!0,events:{hide(){const{fnrStore:t}=e;t.visible=!1,t.showCount=!1,e.fnrSearchList=[],e.fnrActiveModal=!1,e.focus()},show(t){e.fnrActiveModal=t.$modal,Re(e)}},slots:{default(t,l){const{fnrStore:o,fnrSearchList:n}=e,{$modal:r}=t,{activeTab:s,isRE:a,showREErr:c}=o,f=[],u="vxe-table--fnr-";return"replace"===s&&f.push(l("vxe-button",{on:{click:e.triggerFNRReplaceAllEvent}},i(e,"vxe.pro.fnr.btns.replaceAll")),l("vxe-button",{on:{click:e.triggerFNRReplaceEvent}},i(e,"vxe.pro.fnr.btns.replace"))),f.push(l("vxe-button",{on:{click:e.triggerFNRFindAllEvent}},i(e,"vxe.pro.fnr.btns.findAll")),l("vxe-button",{key:"findNext",props:{status:"primary"},on:{click:e.triggerFNRFindEvent}},i(e,"vxe.pro.fnr.btns.findNext")),l("vxe-button",{on:{click(){r.close()}}},i(e,"vxe.pro.fnr.btns.cancel"))),[l("div",{class:u+"tabs"},d.map((t,o)=>l("span",{key:o,class:{"is--active":s===t.value},on:{click(l){e.triggerFNRTabChangeEvent(l,t)}}},i(e,t.label)))),l("div",{class:u+"body"},[l("table",{class:u+"form",attrs:{cellspacing:0,cellpadding:0,border:0}},[l("tbody",[l("tr",{class:"is--visible"},[l("td",{class:u+"form-title"},i(e,"vxe.pro.fnr.findTitle")),l("td",{class:u+"form-content"},[l("vxe-input",{class:u+"form-input",props:{value:o.findValue,clearable:!0},on:{input(e){o.findValue=_e(e)?e.value:e},keydown:e.triggerFNRFindKeydownEvent}})]),l("td",{class:u+"form-filter",attrs:{rowspan:2}},[l("vxe-checkbox",{props:{value:a,content:i(e,"vxe.pro.fnr.filter.re")},on:{input(e){o.isRE=e}}}),l("vxe-checkbox",{props:{value:!a&&o.isWhole,disabled:a,content:i(e,"vxe.pro.fnr.filter.whole")},on:{input(e){o.isRE||(o.isWhole=e)}}}),l("vxe-checkbox",{props:{value:o.isSensitive,content:i(e,"vxe.pro.fnr.filter.sensitive")},on:{input(e){o.isSensitive=e}}})])]),l("tr",{class:{"is--visible":"replace"===o.activeTab}},[l("td",{class:u+"form-title"},i(e,"vxe.pro.fnr.replaceTitle")),l("td",{class:u+"form-content"},[l("vxe-input",{class:u+"form-input",props:{value:o.replaceValue,clearable:!0},on:{input(e){o.replaceValue=_e(e)?e.value:e},keydown:e.triggerFNRReplaceKeydownEvent}})])])])])]),l("div",{class:u+"footer"},f),l("div",{class:u+"search"},[l("div",{class:u+"search-header"},[l("div",i(e,"vxe.pro.fnr.header.seq")),l("div",i(e,"vxe.pro.fnr.header.cell")),l("div",i(e,"vxe.pro.fnr.header.value"))]),l("div",{class:u+"search-body"},[l("vxe-list",{class:u+"search-list",props:{data:n,autoResize:!0,scrollY:{gt:10,sItem:u+"find-item"}},scopedSlots:{default(t,l){const{items:o}=t;return o.map(t=>l("div",{key:t.seq,class:[u+"find-item",{"is--active":t.isActived}],on:{click(l){e.triggerFNRItemEvent(l,t)}}},[l("div",t.seq),l("div","Row:"+(t.row+1)+", Col:"+(t.col+1)),l("div",t.value)]))}}})]),l("div",{class:[u+"search-footer",{"is--error":c,"is--visible":c||o.showCount}]},c?i(e,"vxe.pro.fnr.reError"):i(e,"vxe.pro.fnr.recordCount",[o.findCount]))])]}}}))}function Ee(e,t){const{mouseConfig:l,mouseOpts:o,fnrStore:n}=e;return l&&o.area&&(n.visible?t.value!==n.activeTab&&(n.activeTab=t.value,Re(e)):Ie(e,t)),e.$nextTick()}function Te(e,t){const{afterFullData:l,visibleColumn:o}=t;l.length&&o.length&&(f(e),t.setCellAreas([{type:ft,startRow:st(l),endRow:at(l),startColumn:st(o),endColumn:at(o)}]))}function Fe(e){const t=e.getActiveCellArea(),l=e.getCellAreas();l.length&&e.recalculate().then(()=>{const{copyAreaMpas:o,afterFullData:n,visibleColumn:r}=e,s=[];if(qe(l,e=>{const{type:t,cols:l,rows:o}=e,a=Ue(l,e=>Pe(r,e)),i=Ue(o,e=>Pe(n,e));if(i&&a){const e=Ze(l,e=>Pe(r,e)),d=Ze(o,e=>Pe(n,e));s.push({type:t,startColumn:a,endColumn:e,startRow:i,endRow:d})}}),s.length){let o;t&&(o={area:s[Ke(l,t.area)],row:t.row,column:t.column}),e.setCellAreas(s,o)}else e.clearCellAreas();if(o){const{cols:t,rows:l}=o,s=Je(t,e=>Pe(r,e)),a=Je(l,e=>Pe(n,e));if(-1<s&&-1<a){const i=Ge(t,e=>Pe(r,e)),d=Ge(l,e=>Pe(n,e));o.cols=Ye(t,s,i+1),o.rows=Ye(l,a,d+1),e.copyAreaMpas=H(e,o)}}})}function $e(e,t){const{$vxe:l,editStore:o,keyboardConfig:n,keyboardOpts:a,editConfig:d,editOpts:c,highlightCurrentRow:u,bodyCtxMenu:h,clipOpts:p,fnrOpts:m,ctxMenuStore:g,filterStore:w,copyAreaMpas:C}=t,{modal:v}=l,{actived:x}=o,{activeMethod:b}=c,{keyCode:R}=e,y=32===R,I=37===R,E=38===R,T=39===R,S=40===R,k=8===R,M=46===R,D=88===R,V=67===R,W=86===R,O=70===R,L=e.metaKey,N=e.ctrlKey,H=e.shiftKey,Y=t.getActiveCellArea(),_=d&&x.column&&x.row;if(y&&Y&&n&&a.isChecked){const l=Y.column,o={row:Y.row,column:l};s(l,xt)?(f(e),t.handleToggleCheckRowEvent(e,o)):s(l,bt)&&(f(e),t.triggerRadioRowEvent(e,o))}if(27===R)w.visible&&(e.stopPropagation(),t.closeFilter()),g.visible&&(e.stopPropagation(),t.closeMenu()),C?(e.stopPropagation(),t.clearCopyCellArea()):A(e,t);else if(113===R&&d&&Y){if(!_){const{offsetRow:l,offsetColumn:o}=$(t,Y.row,Y.column);if(r(o.editRender)){const n={row:l,column:o,cell:t.getCell(l,o)};f(e),t.handleActived(n,e)}}}else if(93===R)t._keyCtx=Y&&Y.row&&Y.column&&h.length,clearTimeout(t.keyCtxTimeout),t.keyCtxTimeout=setTimeout(()=>{t._keyCtx=!1},1e3);else if(N&&77===R&&n&&a.isMerge&&Y)_||(f(e),F(t,e),t.clearCopyCellArea());else if(N&&n&&a.isFNR&&(O&&m.isFind||72===R&&m.isReplace)){f(e);const l=t.fnrTabs[O?0:1];t.fnrStore.visible?t.triggerFNRTabChangeEvent(e,l):t.triggerFNROpenEvent(e,l.value),A(e,t)}else if(13===R&&n&&a.isEnter){const{column:l,row:o}=x;if(l&&o){const{offsetRow:n,offsetColumn:r}=$(t,o,l);f(e),t.clearActived(),a.enterToTab?ge(e,t,{row:n,column:r},H):fe(e,t,{row:n,column:r},!1,H,!1,!H)}else Y&&(f(e),a.enterToTab?ge(e,t,Y,H):fe(e,t,Y,!1,H,!1,!H))}else if((I||E||T||S)&&n&&a.isArrow){if(!_)if(!Y)(E||S)&&u&&t.moveCurrentRow(E,S,e);else if(H){const l=t.getCellAreas();1>=l.length?he(e,t,Y,I,E,T,S):v&&v.message({message:i(t,"vxe.pro.area.multiErr"),status:wt,id:gt})}else fe(e,t,Y,I,E,T,S);}else if(9===R&&n&&a.isTab){const{column:l,row:o}=x;if(o&&l){const{offsetRow:n,offsetColumn:r}=$(t,o,l);f(e),t.clearActived(),ge(e,t,{row:n,column:r},H)}else Y&&(f(e),ge(e,t,Y,H))}else if((M||k)&&n&&a.isDel){const{delMethod:l,backMethod:o}=a;if(!_)if(k&&Y){const{column:l,row:n}=Y;if(n&&l){const{offsetRow:s,offsetColumn:a}=$(t,n,l);if(r(a.editRender)){const l={row:s,rowIndex:t.getRowIndex(s),column:a,columnIndex:t.getColumnIndex(a),cell:t.getCell(s,a),$table:t};(!b||b(l))&&(o?o(l):(l.cell=t.getCell(s,a),rt(s,a.property,null),t.handleActived(l,e)))}}}else if(M){const e=t.getCellAreas();qe(e,e=>{const{rows:o,cols:n}=e;qe(o,e=>{qe(n,o=>{if(r(o.editRender)){const n=t.getRowIndex(e),r=t.getColumnIndex(o),s={row:e,rowIndex:n,column:o,columnIndex:r,cell:t.getCell(e,o),$table:t};(!b||b({row:e,column:o}))&&(l?l(s):rt(e,o.property,null))}})})})}}else if(n&&N&&65===R)_||Te(e,t);else if(n&&a.isClip&&N&&it.msie&&(D||V||W)){if(!_){const l=window.clipboardData;if(l&&q(t))if(D&&!1!==p.isCut||V&&!1!==p.isCopy){const o=z(t,e,D),{text:n,status:r}=o;l.setData("text",n),r&&j(t,o,D)}else if(W&&!1!==p.isPaste){const o=l.getData("text");ee(t,e,{text:o})}}}else if(n&&d&&a.isEdit&&!N&&!L&&(y||48<=R&&57>=R||65<=R&&90>=R||96<=R&&111>=R||186<=R&&192>=R||219<=R&&222>=R)&&!_&&Y){const{column:l,row:o}=Y;if(o&&l){const{offsetRow:n,offsetColumn:s}=$(t,o,l),{editMethod:i}=a;if(r(s.editRender)){const l={row:n,rowIndex:t.getRowIndex(n),column:s,columnIndex:t.getColumnIndex(s),cell:t.getCell(n,s),$table:t};(!b||b(l))&&(i?i(l):(rt(n,s.property,null),t.handleActived(l,e)))}}}}function Se(e,t){return t.map(e=>e.map(e=>{let t=0;const l=!isNaN(e);let o="{0}";return l?t=e:o=et(e).replace(/\d+(?!.*\d)/,e=>(t=e,"{0}")),{v:o,n:Qe(t),t:l}}))}function ke(t,l,o){const{targetValues:n,targetRows:r,extendRows:s,extendCols:a}=l,i=Se(t,n),d=i[o?0:i.length-2],c=i[o?1:i.length-1],f=a.map((e,t)=>{const l=d[t],n=c[t];return{offset:o?l.n-n.n:n.n-l.n,num:o?l.n:n.n}}),u=s.map((t,l)=>{const n=l%r.length,s=i[o?i.length-n-1:n];return a.map((t,l)=>{const o=s[l],n=f[l],{num:r,offset:a}=n,i=r+a;return!o.t&&0>=i&&(n.offset=e(a)),n.num=i,tt(o.v,[i])})});return o&&u.reverse(),u}function Me(t,l,o){const{targetValues:n,targetCols:r,extendRows:s,extendCols:a}=l,i=Se(t,n),d=i.map(e=>{const t=e[o?0:e.length-2],l=e[o?1:e.length-1];return{offset:o?t.n-l.n:l.n-t.n,num:o?t.n:l.n}});return s.map((t,l)=>{const n=d[l],s=i[l],c=a.map((t,l)=>{const a=l%r.length,i=s[o?s.length-a-1:a],{num:d,offset:c}=n,f=d+c;return!i.t&&0>=f&&(n.offset=e(c)),n.num=f,tt(i.v,[f])});return o&&c.reverse(),c})}function De(e,t,l,o,n){const{afterFullData:r,visibleColumn:s,areaOpts:a={}}=e,{rows:i,cols:d}=n,c=i.length>l.length,f=d.length>o.length,u=t.shiftKey,h=t.ctrlKey;let p;if(!u&&(c||f)){const{extendByCopy:t,extendByCalc:n,extendCalcMethod:u,extendSetMethod:m,beforeExtendSetMethod:g,afterExtendSetMethod:w}=a,C=Ke(r,l[0]),v=Ke(r,i[0]),x=Ke(s,o[0]),b=Ke(s,d[0]);let R=!1,y=!1,A=[];if(c){const r=!h&&n&&2<=l.length;if(t||r){let t=[];A=l.map(t=>o.map(l=>P(e,t,l,0))),v<C?(R=!0,t=i.slice(0,i.length-l.length)):t=i.slice(l.length);const n={rows:i,cols:d,targetValues:A,targetRows:l,targetCols:o,extendRows:t.slice(0),extendCols:o,direction:R?"up":"down",$table:e};g&&!1===g(n)||(p=A,r&&(u?p=u(n):p=ke(e,n,R)),t.forEach((e,l)=>{const r=R?t.length%p.length:0,s=(r+l)%p.length,a=p[s];o.forEach((t,l)=>{const o=a[l%a.length];if(m)m(He({cellValue:o,row:e,column:t},n));else{const{property:l}=t;l&&rt(e,l,o)}})}),w&&w(He({extendValues:p},n)))}}else if(f){const r=!h&&n&&2<=o.length;if(t||r){let t=[];b<x?(y=!0,t=d.slice(0,d.length-o.length)):t=d.slice(o.length),A=l.map(t=>o.map(l=>P(e,t,l,0)));const n={rows:i,cols:d,targetValues:A,targetRows:l,targetCols:o,extendRows:l,extendCols:t.slice(0),direction:y?"left":"right",$table:e};g&&!1===g(n)||(p=A,r&&(u?p=u(n):p=Me(e,n,y)),l.forEach((e,l)=>{const o=l%p.length,r=p[o],s=y?t.length%r.length:0;t.forEach((t,l)=>{const o=(s+l)%r.length,a=r[o];if(m)m(He({cellValue:a,row:e,column:t},n));else{const{property:l}=t;l&&rt(e,l,a)}})}),w&&w(He({extendValues:p},n)))}}}}function Ve(t,l,n){const{button:r}=t;if(!(0===r))return;const{fixed:s}=n,a=l.getCellAreas(),f=Ue(a,e=>e.type===ft);if(d(l),f){const r=document.onmousemove,a=document.onmouseup,{$el:p,$refs:v,$vxe:x,afterFullData:b,visibleColumn:R}=l,{modal:y}=x,A=t.clientX,E=t.clientY,{tableBody:T,rightBody:F,tableFooter:$}=v,S=T.$el,D=F?F.$el:null,V=$?$.$el:null,L=D||S,N=V||S,{rows:Y,cols:_}=f,B=st(_),K=st(Y),P=at(_),X=at(Y),q=f.top,j=f.left,z=f.width,U=f.height,Z=C(l,B.fixed),G=u(Z,".vxe-table--cell-area"),J=G.children[2],Q=L.scrollTop,ee="left"===s?0:N.scrollLeft,te=Ke(b,X),le=Ke(R,P),ne=I(l,te,le);let re,se=1,ae=1,ie=0,de=0,ce=null,fe=null;const ue=u(Z,".vxe-body--row"),he=ue.firstChild,pe={el:null,type:ht,cols:[],rows:[],top:0,left:0,width:0,height:0},me=t=>{const{offsetTop:n,offsetLeft:r}=we(t,l,s,A,E,ee,Q,N,L),a=e(n),i=e(r),d=N.scrollWidth,c=L.scrollHeight;let f=U,u=z,h=q,p=j;switch(re){case"top":if(n<-U){const e=o(q,k(l,K,B,ne,!1,a-U));h-=e,f+=e}break;case"bottom":0<n&&(f+=o(c-q-U,k(l,X,P,ne,!0,a)));break;case"left":if(r<-z){const e=o(j,M(l,K,B,ne,!1,i-z));p-=e,u+=e}break;case"right":0<r&&(u+=o(d-j-z,M(l,X,P,ne,!0,i)));}pe.height=f,pe.width=u,pe.left=p,pe.top=h,pe.cols=W(l,he,pe),pe.rows=O(l,ue,pe),He(pe,H(l,pe))},ge=e=>{d(l),l._msTout=setTimeout(()=>{if(l._msTout){const{clientHeight:t,clientWidth:o}=S,{scrollLeft:n,scrollWidth:r}=N,{scrollTop:s,scrollHeight:a}=L;let i,c;null!==ce&&(ce?s+t<a&&(i=s+se*Ct):s&&(i=s-se*Ct)),null!==fe&&(fe?n+o<r&&(c=n+ae*Ct):n&&(c=n-ae*Ct)),Le(c)||Le(i)?(l.scrollTo(c,i),ge(e),me(e)):d(l)}},50)};document.onmousemove=e=>{c(e);const{clientY:t,clientX:o}=e,{clientHeight:n,clientWidth:r}=S,{offsetTop:a,offsetLeft:i}=we(e,l,s,A,E,ee,Q,N,L),f=h(S),u=f.top,p=f.left,m=j+z+i,g=q+U+a;let w;ce=null,fe=null,ie=t,de=o,ie<u?(w=!0,ce=!1,se=u-ie):ie>u+n&&(w=!0,ce=!0,se=ie-u-n),de<p?(w=!0,fe=!1,ae=p-de):de>p+r&&(w=!0,fe=!0,ae=de-p-r),m<j?g>q&&g<q+U&&(re="left"):m>j+z?g>q&&g<q+U&&(re="right"):g<q?re="top":g>q+U&&(re="bottom"),w?!l._msTout&&ge(e):d(l),me(e)},document.onmouseup=()=>{document.onmousemove=r,document.onmouseup=a,d(l),w(p,"drag--extend-range");const e=O(l,ue,pe),o=W(l,he,pe);oe(l,e,o)?(f.rows=e,f.cols=o):y&&y.message({message:i(l,"vxe.pro.area.extendErr"),status:wt,id:gt}),He(f,H(l,f)),m(J),De(l,t,Y,_,f),l._isCAEd=!1,l.emitEvent("cell-area-extension-end",{rows:f.rows,cols:f.cols,targetRows:Y,targetCols:_},t)},g(p,"drag--extend-range"),l._isCAEd=!0,l.emitEvent("cell-area-extension-start",n,t)}}function We(t,l,n){const{button:r}=t,s=2===r;if(!(0===r||s))return;const{$el:a,$refs:i,editStore:x,editOpts:R,_isCAEd:y}=l,{actived:A}=x,{fixed:I,row:T,column:F,cell:$}=n;if(y)return void f(t);if(A.row===T&&("cell"===R.mode?A.column===F:"row"===R.mode))return;const k=t.ctrlKey,M=t.shiftKey,L=$.offsetTop,N=$.offsetLeft,Y=$.offsetWidth,_=$.offsetHeight;let B=l.getCellAreas();const K=l.getActiveCellArea();if(d(l),!s&&M&&K)return void ue(t,l,K,B,n);if(l.clearActived(t),l.clearSelected(),!s||!ot(B,e=>Pe(e.rows,T)&&Pe(e.cols,F))){k||(B=[],l.clearCellAreas());const r=document.onmousemove,f=document.onmouseup,x=t.clientX,R=t.clientY,{tableBody:y,rightBody:A,tableFooter:M}=i,K=E(t,$),P=y.$el,X=A?A.$el:null,q=M?M.$el:null,j=X||P,z=q||P,U=C(l,F.fixed),Z=u(U,".vxe-table--cell-area"),G=Z.children,J=G[0],Q=G[2],ee=G[3],te=$.parentNode,le=u(U,".vxe-body--row"),oe=le.firstChild,ne=j.scrollTop,re="left"===I?0:z.scrollLeft;let se=null,ae=null,ie=1,de=1,ce=0,fe=0;const ue={el:null,type:k?pt:ft,cols:[],rows:[],top:0,left:0,width:0,height:0},he={el:null,type:mt,area:ue,column:F,row:T,top:$.offsetTop,left:$.offsetLeft,width:$.offsetWidth,height:$.offsetHeight};if(k){const e=I?`${I}El`:"el",t=Ue(B,e=>e.type===ft);t&&(t.type=pt,t[e]=v(ee),b(t[e],t)),ue[e]=v(ee)}l.setActiveCellArea(he),B.push(ue),l.activeCellArea=he;const pe=t=>{const{offsetTop:n,offsetLeft:r}=we(t,l,I,x,R,re,ne,z,j),s=z.scrollWidth,a=j.scrollHeight,i=0<=n,d=0<=r;let c,f,u=e(n),h=e(r);i?(c=D(l,T,F,te,i,u+K.offsetY),u=o(a-L,c.moveHeight)):(c=D(l,T,F,te,i,u-K.offsetY),u=o(L+_,c.moveHeight)),d?(f=V(l,T,F,$,d,h+K.offsetX),h=o(s-N,f.moveWidth)):(f=V(l,T,F,$,d,h-K.offsetX),h=o(N+Y,f.moveWidth));const{rows:g,cols:w}=S(l,c.rows,f.cols);ue.rows=g,ue.cols=w,m(Q),k?(m(J),p(ee)):(m(ee),p(J)),He(ue,H(l,ue))},me=e=>{d(l),l._msTout=setTimeout(()=>{if(l._msTout){const{clientHeight:t,clientWidth:o}=P,{scrollLeft:n,scrollWidth:r}=z,{scrollTop:s,scrollHeight:a}=j;let i,c;null!==se&&(se?s+t<a&&(i=s+ie*Ct):s&&(i=s-ie*Ct)),null!==ae&&(ae?n+o<r&&(c=n+de*Ct):n&&(c=n-de*Ct)),Le(c)||Le(i)?(l.scrollTo(c,i),me(e),pe(e)):d(l)}},50)};s||(document.onmousemove=e=>{c(e);const{clientY:t,clientX:o}=e,{clientHeight:n,clientWidth:r}=P,s=h(P),a=s.top,i=s.left;let f;se=null,ae=null,ce=t,fe=o,ce<a?(f=!0,se=!1,ie=a-ce):ce>a+n&&(f=!0,se=!0,ie=ce-a-n),fe<i?(f=!0,ae=!1,de=i-fe):fe>i+r&&(f=!0,ae=!0,de=fe-i-r),f?!l._msTout&&me(e):d(l),pe(e)}),document.onmouseup=()=>{document.onmousemove=r,document.onmouseup=f,d(l),ue.cols=W(l,oe,ue),ue.rows=O(l,le,ue),w(a,"drag--area"),l.emitEvent("cell-area-selection-end",{rows:ue.rows,cols:ue.cols},t)},g(a,"drag--area"),pe(t),l.cellAreas=B,l.emitEvent("cell-area-selection-start",n,t)}}const{uniqueId:Oe,isNumber:Le,browse:Ne,assign:He,slice:Ye,isObject:_e,isBoolean:Be,indexOf:Ke,includes:Pe,eachTree:Xe,arrayEach:qe,hasOwnProp:je,toInteger:ze,find:Ue,findLast:Ze,findLastIndexOf:Ge,findIndexOf:Je,toNumber:Qe,toValueString:et,toFormatString:tt,filter:lt,some:ot,get:nt,set:rt,first:st,last:at}=XEUtils,it=Ne(),dt="\r\n",ct=["X","E","0","0","0","0","1","3","4"].join(""),ft="main",ut="copy",ht="extend",pt="multi",mt="active",gt="operErr",wt="error",Ct=4,vt="seq",xt="checkbox",bt="radio",Rt={children:"children"},yt="\t";"undefined"!=typeof window&&(window.VXETableMixin={data(){return{fnrStore:{visible:!1,activeTab:"",findValue:"",replaceValue:"",isRE:!1,isWhole:!1,isSensitive:!1,showREErr:!1,showCount:!1,findCount:0},fnrSearchList:[],fnrTabs:[{value:"find",label:"vxe.pro.fnr.tabs.find"},{value:"replace",label:"vxe.pro.fnr.tabs.replace"}],azIndex:0,fnrActiveModal:null}},mounted(){const{$el:e}=this;e&&e.setAttribute("pro-auth",ct)},beforeDestroy(){const{$el:e,fnrActiveModal:t}=this;e&&e.removeAttribute("pro-auth"),t&&t.close()},methods:{handleHeaderCellAreaEvent(e,t){const{mouseConfig:l,mouseOpts:o,afterFullData:n,areaOpts:r}=this,{triggerFilter:s,column:a}=t;l&&o.area&&(s?this.clearCopyCellArea():(!r||!1!==r.selectCellByHeader)&&(n.length?(this.clearActived(),setTimeout(()=>{const l=st(n),o=[];Xe([a],e=>{e.children&&e.children.length||o.push(e)},Rt);const r=st(o),s=at(o);this.$nextTick(()=>{this.clearCopyCellArea(),this.setCellAreas([{type:ft,startColumn:r,endColumn:s,startRow:l,endRow:at(n)}],{column:r,row:l})}),this.scrollToRow(l,r),this.emitEvent("header-cell-area-selection",He({targetRows:n.slice(0),targetCols:o},t),e)},10)):(this.clearCellAreas(),this.clearCopyCellArea())))},handleUpdateCellAreas(){Fe(this)},_getCellAreas(){return this.cellAreas||[]},_clearCellAreas(){return R(this,e=>{const t=e.children,l=t[0],o=t[2],n=t[3],r=t[4];if(m(l),m(l.firstChild),m(o),m(r),n){const e=n.children;for(let t=e.length-1;0<=t;t--)n.removeChild(e[t])}}),this.activeCellArea=null,this.cellAreas=[],this.$nextTick()},_getCopyCellArea(){return this.copyAreaMpas||null},_clearCopyCellArea(){return y(this,ut),this.copyAreaMpas=null,this.$nextTick()},_setCellAreas(e,t){if(e&&e.length){this.clearCellAreas();let l=Ue(e,e=>e.type===ft),o=[];if(l||(l=Ue(e,e=>!e.type),l&&(l.type=ft)),l){const e=Y(this,l);o=e?[e]:[]}else{const t=[];qe(e,e=>{const l=Y(this,e);l&&t.push(l)}),o=t}if(o.length){const l=o[0],{cols:n,rows:r}=l;let s=null;if(t){const{area:n,row:r,column:a}=t;r&&a&&(s={area:n?o[Ke(e,n)]||l:l,row:r,column:a})}this.setActiveCellArea(He({type:mt,area:l,column:at(n),row:at(r)},s))}this.cellAreas=o}return this.$nextTick()},_setActiveCellArea(e){return y(this,mt),this.activeCellArea=L(this,He({},e,{type:mt})),this.$nextTick()},_getActiveCellArea(){return this.activeCellArea||null},handleKeyboardEvent(e){$e(e,this)},_openFind(){const{fnrTabs:e,fnrOpts:t}=this;return t.isFind?Ee(this,e[0]):this.$nextTick()},_openReplace(){const{fnrTabs:e,fnrOpts:t={}}=this;return t.isReplace?Ee(this,e[1]):this.$nextTick()},triggerFNROpenEvent(e,t){const{fnrStore:l,fnrTabs:o}=this;Ee(this,Ue(o,e=>e.value===t)||o[0]),this.emitEvent("open-fnr",{tab:l.activeTab},e)},triggerFNRTabChangeEvent(e,t){const{fnrStore:l}=this;l.activeTab!==t.value&&(l.activeTab=t.value,Re(this),this.emitEvent("change-fnr",{tab:l.activeTab},e))},triggerFNRFindKeydownEvent(e){const{$event:t}=e;13===t.keyCode&&("replace"===this.fnrStore.activeTab?this.triggerFNRReplaceEvent(e):this.triggerFNRFindEvent(e))},triggerFNRFindEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,{beforeFindMethod:n}=l,r=et(t.findValue);if(!t.showREErr&&!(n&&!1===n({findValue:r,$table:this}))){const e=ye(this);Ae(this),!e.length&&o&&o.message({message:i(this,"vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})}},triggerFNRFindAllEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,{beforeFindMethod:n}=l,r=et(t.findValue);if(this.fnrSearchList=[],t.showREErr)return;if(n&&!1===n({findValue:r,$table:this}))return;const s=ye(this,!0);t.findCount=s.length,t.showCount=!0,s.length?setTimeout(()=>{this.fnrSearchList=s.map((e,t)=>{const l=et(nt(e.offsetRow,e.offsetColumn.property));return{seq:t+1,row:e._rowIndex,col:e._columnIndex,isActived:!1,value:l||i(this,"vxe.pro.fnr.empty")}})},10):o&&o.message({message:i(this,"vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})},triggerFNRItemEvent(e,t){const{afterFullData:l,visibleColumn:o}=this,n=l[t.row],r=o[t.col];n&&r&&(Ae(this),t.isActived=!0,this.scrollToRow(n,r),this.setCellAreas([{type:ft,startRow:n,endRow:n,startColumn:r,endColumn:r}]))},triggerFNRReplaceKeydownEvent(e){const{$event:t}=e;13===t.keyCode&&this.triggerFNRReplaceEvent(e)},triggerFNRReplaceEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,n=this.getActiveCellArea(),r=et(t.findValue),s=et(t.replaceValue);if(Ce(this,r)&&(r||s))if(n){const{beforeReplaceMethod:e,replaceMethod:t}=l,{row:a,column:d}=n;if(e&&!1===e({findValue:r,replaceValue:s,$table:this}))return;ve(this,a,d,r)?(t?t({row:a,column:d,cellValue:s}):rt(a,d.property,s),ye(this),Ae(this)):o&&o.message({message:i(this,"vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})}else o&&o.message({message:i(this,"vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})},triggerFNRReplaceAllEvent(){const{$vxe:e,fnrStore:t,fnrOpts:l}=this,{modal:o}=e,n=et(t.findValue),r=et(t.replaceValue);if(n||r){const{beforeReplaceMethod:e,replaceMethod:s}=l;if(t.showREErr)return;if(e&&!1===e({findValue:n,replaceValue:r,$table:this}))return;const a=ye(this,!0);Ae(this),a.length?(qe(a,e=>{const{offsetRow:t,offsetColumn:l}=e;s?s({row:t,column:l,cellValue:r}):rt(t,l.property,r)}),o&&o.message({message:i(this,"vxe.pro.fnr.replaceSuccess",[a.length]),status:"success",id:"operEnd"})):o&&o.message({message:i(this,"vxe.pro.fnr.notCell"),status:"warning",id:"operWarn"})}},handleCopyCellAreaEvent(e){const{clipOpts:t}=this;if(!1!==t.isCopy&&q(this)){const t=e.clipboardData;if(t){const l=z(this,e,!1),{text:o,html:n,status:r}=l;t.setData("text/plain",o),t.setData("text/html",n),r&&j(this,l,!1)}}},handleCutCellAreaEvent(e){const{clipOpts:t}=this;if(!1!==t.isCut&&q(this)){const t=e.clipboardData;if(t){const l=z(this,e,!0),{text:o,html:n,status:r}=l;t.setData("text/plain",o),t.setData("text/html",n),r&&j(this,l,!0)}}},handlePasteCellAreaEvent(e){const{clipOpts:t}=this;if(!1!==t.isPaste&&q(this)){const t=e.clipboardData;if(t){const l=t.getData("text/plain");l&&ee(this,e,{text:l})}}},_copyCellArea(){const e=z(this,null,!1),{text:t,html:l,status:o}=e;return o&&j(this,e,!1),{text:t,html:l}},_cutCellArea(){const e=z(this,null,!0),{text:t,html:l,status:o}=e;return o&&j(this,e,!0),{text:t,html:l}},_pasteCellArea(){const{$vxe:e}=this,{clipboard:t}=e;return t&&(t.html||t.text)&&ee(this,null,t),this.$nextTick()},triggerCellExtendMousedownEvent(e,t){ct&&Ve(e,this,t)},handleCellAreaEvent(e,t){ct&&We(e,this,t)}}})})();